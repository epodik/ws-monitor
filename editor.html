<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>WS Monitor GUI Editor</title>
    <link href="https://unpkg.com/grapesjs/dist/css/grapes.min.css" rel="stylesheet"/>
    <script src="https://unpkg.com/grapesjs"></script>
    <style>
      body, html { height: 100%; margin: 0; }
      #gjs { height: 100%; }
    </style>
  </head>
  <body>
    <div id="gjs">Loading your current index.html...</div>

    <script>
      // Загружаем содержимое текущего index.html
      fetch('/index.html')
        .then(res => res.text())
        .then(html => {
          // Убираем лишние <script> (чтобы не ломать редактор)
          html = html.replace(/<script[\s\S]*?>[\s\S]*?<\/script>/gi, '');
          
          // Инициализация GrapesJS
          const editor = grapesjs.init({
            container: '#gjs',
            height: '100%',
            width: 'auto',
            fromElement: false,
            storageManager: false,
            plugins: ['gjs-blocks-basic'],
          });

          editor.setComponents(html);
        })
        .catch(err => {
          document.getElementById('gjs').textContent = 'Error loading index.html: ' + err;
        });
    </script>
  </body>
</html>
